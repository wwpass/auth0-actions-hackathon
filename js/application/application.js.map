{"version":3,"file":"application.js","sources":["src/blocks/user/user.js","src/blocks/application/application.js"],"sourcesContent":["const userBlock = document.querySelector(`.user`);\nconst userPopup = userBlock.querySelector(`.user__popup`);\nconst closePopup = userBlock.querySelector(`.user__popup-close`);\nconst overlay = document.querySelector(`.overlay`);\n\nconst closePopupOnClick = (evt) => {\n  // evt.preventDefault();\n  userPopup.style.display = `none`;\n  overlay.style.display = `none`;\n  setTimeout(() => {\n    userBlock.addEventListener(`click`, userOnClick);\n  }, 100);\n};\n\nconst userOnClick = () => {\n  userPopup.style.display = `flex`;\n  overlay.style.display = `block`;\n  userBlock.removeEventListener(`click`, userOnClick);\n};\n\nif (userBlock) {\n  userBlock.addEventListener(`click`, userOnClick);\n  closePopup.addEventListener(`click`, closePopupOnClick);\n  overlay.addEventListener(`click`, closePopupOnClick);\n}\n\nexport {closePopupOnClick}","import {closePopupOnClick} from '../user/user.js';\n\nconst application = document.querySelector(`.application`);\nconst apps = application.querySelector(`.apps`);\n\nconst nameParser = (nameKey) => {\n  let convertedName = nameKey.replace(`_`, ` `);\n  convertedName.trim();\n  return convertedName.replace(convertedName[0], convertedName[0].toUpperCase());;\n};\n\nfunction escapeHTML(unsafeText) {\n  let div = document.createElement('div');\n  div.innerText = unsafeText;\n  return div.innerHTML;\n}\n\nconst profileStringHandler = (key, value, editable) => {\n  const editBtn = editable ? `\n    <svg class=\"profile__edit\" id=\"profile_edit_${key}\" width=\"24\" height=\"24\">\n      <use xlink:href=\"${window.imgPath}/sprite.svg#icon-edit\"></use>\n    </svg>` : ``;\n  return `<div class=\"profile__field\">\n  <div class=\"profile__name\">${nameParser(key)}:</div>\n  <div class=\"profile__content profile__content--long\">${escapeHTML(value)}</div>${editBtn}\n</div>`;\n};\n\n\nconst profileDateHandler = (key, value) => {\n  const convertedDate = new Date(value).toUTCString();\n\n  return `<div class=\"profile__field\">\n    <div class=\"profile__name\">${nameParser(key)}:</div>\n    <div class=\"profile__content\">${convertedDate}</div>\n  </div>`\n};\n\nconst profileArrayHandler = (key, value) => {\n  let itemsLayout = ``;\n  value.forEach((item) => {\n    itemsLayout += `<li class=\"profile__item\">${escapeHTML(item)}</li>`;\n  });\n\n  return `<div class=\"profile__field\">\n    <div class=\"profile__name\">${nameParser(key)}:</div>\n    <div class=\"profile__content profile__content--groups profile__content--long\">\n      <ul class=\"profile__list\">\n        ${itemsLayout}\n      </ul>\n    </div>\n  </div>`;\n};\n\nconst backBtnOnClick = (profileElement) => {\n  apps.style.display = `block`;\n  profileElement.style.display = `none`;\n};\n\nconst editBtnOnClick = (profileElement, key, value, xsrf) => {\n  const editBtn = profileElement.querySelector(`#profile_edit_${key}`);\n  if (!editBtn) return;\n  const profileContentElement = editBtn.parentElement.querySelector('.profile__content');\n  const elementEditForm = `<form action=\"\" method=\"POST\">\n  <input type=\"text\" class=\"profile-input\" name=\"edit_${key}\"/>\n  <input type=\"hidden\" name=\"action\" value=\"edit_${key}\"/>\n  ${xsrf}\n  <button type=\"submit\">Change</button>\n  </form>`\n  editBtn.parentElement.removeChild(editBtn);\n  profileContentElement.innerHTML = elementEditForm;\n  profileContentElement.querySelector('.profile-input').value = value;\n};\n\nconst profileBtnOnClick = (dictObj, editableKeys, xsrf_form_html) => {\n  closePopupOnClick();\n  apps.style.display = `none`;\n\n  const profile = application.querySelector(`.profile`);\n\n  if (profile) {\n    profile.style.display = `flex`;\n  } else {\n    let profileLayout = `\n    <h1 class=\"heading heading--h1 heading--center heading--marginBottom-15 heading--light\"><span class=\"profile__back\"><span class=\"profile__backIcon\"></span></span>User Profile</h1>`;\n\n      for (const [key, value] of Object.entries(dictObj)) {\n        const editable = editableKeys? editableKeys.includes(key) : false;\n        // Currently only string values can be editable\n        if (typeof value === `number`) {\n          profileLayout += profileDateHandler(key, value);\n        }\n        if (Array.isArray(value)){\n          profileLayout += profileArrayHandler(key, value);\n        }\n        if (typeof value === `string`) {\n          profileLayout += profileStringHandler(key, value, editable);\n        }\n\n      }\n      profileLayout += `<button class=\"button button--common button--marginBottom-0 button--back\">Back to Applications</button>`;\n\n    const profileElement = document.createElement(`div`);\n    profileElement.classList.add(`profile`);\n    profileElement.innerHTML = profileLayout;\n    const backBtn = profileElement.querySelector(`.button--back`);\n    backBtn.addEventListener(`click`, () => {\n      backBtnOnClick(profileElement);\n    });\n    const backIcon = profileElement.querySelector(`.profile__back`);\n    backIcon.addEventListener(`click`, () => {\n      backBtnOnClick(profileElement);\n    });\n    if (editableKeys) {\n      for (const key of editableKeys) {\n        const editBtn = profileElement.querySelector(`#profile_edit_${key}`);\n        if (editBtn) {\n          editBtn.addEventListener(`click`, (e)=> {\n            editBtnOnClick(profileElement, key, dictObj[key], xsrf_form_html);\n            e.preventDefault();\n          });\n        }\n      }\n    }\n\n    application.appendChild(profileElement);\n  }\n};\n\nwindow.profileBtnOnClick = profileBtnOnClick;"],"names":[],"mappings":"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"}